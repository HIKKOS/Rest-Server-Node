// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Tutor {
  Id              String        @id
  Nombres         String     @db.VarChar(75)
  ApellidoMaterno String     @db.VarChar(75)
  ApellidoPaterno String?      @db.VarChar(75)
  Foto String? @db.VarChar(75)
  Correo          String     @unique @db.VarChar(255)
  Telefono        String     @unique @db.VarChar(20)
  RFC             String     @unique @db.VarChar(15)
  PasswordTutor   String     @db.VarChar(255)
  Direccion       String?     @db.VarChar(150)
  CreatedAt       DateTime   @default(now())
  Tutorado        Alumno[]
  Pagos Pago[]
  MetodoPago      MetodoPago @default(null)
  Activo Boolean @default(true)
}

model Alumno {
  Id              String        @id
  Nombres         String     @db.VarChar(75)
  ApellidoMaterno String     @db.VarChar(75)
  ApellidoPaterno String?     @db.VarChar(75)
  Servicio        Servicio[]
  Grado           Int        @default(1)
  Grupo           String     @default("A") @db.VarChar(20)
  Genero          Int    
  CreatedAt       DateTime   @default(now())
  Padre           Tutor?     @relation(fields: [TutorId], references: [Id])
  TutorId         String? 
  Activo Boolean @default(true)
}

model Servicio {
Id          String        @id
  Nombre      String     @db.VarChar(75)
  Prioritario Boolean    @default(true)
  Imagenes    ImgPaths[]
  Descripcion String     @db.VarChar(500)
  //TODO: Fecha corte
  FechaPago   DateTime   @default(now())
  Precio      Float      @default(0.0)
  Alumno      Alumno[] 
  Pago Pago[]    
  Activo Boolean @default(true)
}
model Pago {
  Servicio    Servicio  @relation(fields: [ServicioId], references: [Id])
  ServicioId  String
  Tutor       Tutor     @relation(fields: [TutorId], references: [Id])
  TutorId     String
  AlumnoId    Int
  FechaPago   DateTime   @default(now())
  Precio      Float      
  @@id([ServicioId, TutorId, AlumnoId])
}
model Administrador {
  Id              Int    @id @default(autoincrement())
  Nombres         String @db.VarChar(75)
  ApellidoMaterno String @db.VarChar(75)
  ApellidoPaterno String? @db.VarChar(75)
  Correo          String @unique @db.VarChar(255)
  PasswordAdmin   String @db.VarChar(255)
  Activo Boolean @default(true)
}

model ImgPaths {
  Id       Int      @id @default(autoincrement())
  ServicioId   String
  Path     String
  Servicio Servicio? @relation(fields: [ServicioId], references: [Id])
}

enum MetodoPago {
  PayPal
  null
}

enum Genero {
  MASCULINO
  FEMENINO
}
