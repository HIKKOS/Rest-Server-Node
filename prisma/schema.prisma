// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Tutor {
  Id              String        @id
  Nombres         String     @db.VarChar(75)
  ApellidoMaterno String     @db.VarChar(75)
  ApellidoPaterno String?      @db.VarChar(75)
  Foto String? @db.VarChar(75)
  Correo          String     @unique @db.VarChar(255)
  Telefono        String     @unique @db.VarChar(20)
  RFC             String?     @unique @db.VarChar(15)
  PasswordTutor   String     @db.VarChar(255)
  Direccion       String?     @db.VarChar(150)
  CreatedAt       DateTime   @default(now())
  Tutorado        Alumno[]
  Pagos Pago[]
  MetodosdePago      MetodoPago[] 
  Activo Boolean @default(true)
}
model MetodoPago{
  Id String @id
  Nombre String 
  TutorId String
  Tutor Tutor @relation(fields: [TutorId], references: [Id] )

}
model Alumno {
  Id              String        @id
  Nombres         String     @db.VarChar(75)
  ApellidoMaterno String     @db.VarChar(75)
  ApellidoPaterno String?     @db.VarChar(75)
  Servicios        ServiciosDelAlumno[]
  Grado           Int        @default(1)
  Grupo           String     @default("A") @db.VarChar(20)
  Genero          Int    
  CreatedAt       DateTime   @default(now())
  Padre           Tutor?     @relation(fields: [TutorId], references: [Id])
  TutorId         String? 
  Activo Boolean @default(true)
}
model ServiciosDelAlumno {
  Id String @id
  AlumnoId    String
  ServicioId  String
  Alumno      Alumno     @relation(fields: [AlumnoId], references: [Id])
  Servicio    Servicio   @relation(fields: [ServicioId], references: [Id])
  Monto Float
  VecesPagado Int @default(1)
}
model Servicio {
  Id          String        @id
  Nombre      String     @db.VarChar(75)
  Prioritario Boolean    @default(true)
  Imagenes    ImgPaths[]
  Descripcion String     @db.VarChar(500)
  //TODO: Fecha corte
  FechaPago   Int   
  Precio      Float      @default(0.0)
  Alumno      ServiciosDelAlumno[] 
  Pago Pago[]    
  Activo Boolean @default(true)
  FrecuenciaDePago Frecuencia @default(MENSUAL)
}
enum Frecuencia {
  SEMANAL
  MENSUAL
  BIMESTRAL
  SEMESTRAL
  ANUAL
}
model Pago {
  Folio Int @id @default(autoincrement())
  Servicio    Servicio  @relation(fields: [ServicioId], references: [Id])
  ServicioId  String
  Tutor       Tutor     @relation(fields: [TutorId], references: [Id])
  TutorId     String
  AlumnoId    String
  FechaPago   DateTime   @default(now())
  Monto      Float     
  Facturar Boolean @default(false) 
}
model Administrador {
  Id              String @id
  Nombres         String @db.VarChar(75)
  ApellidoMaterno String @db.VarChar(75)
  ApellidoPaterno String? @db.VarChar(75)
  Correo          String @unique @db.VarChar(255)
  PasswordAdmin   String @db.VarChar(255)
  Activo Boolean @default(true)
}

model ImgPaths {
  Id       Int      @id @default(autoincrement())
  ServicioId   String
  Path     String
  Servicio Servicio? @relation(fields: [ServicioId], references: [Id])
}
